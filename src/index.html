<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Stencil Component Starter</title>
    <link rel="stylesheet" href="/build/components.css" />
    <script type="module" src="/build/components.esm.js"></script>
    <!-- <script nomodule src="/build/components.js"></script> -->
    <style>
      :root {
        --primary-hue: 352.8;
        --primary-lightness: 43.9%;
        --success-hue: 213.8;
        --success-lightness: 25.1%;
      }

      .container {
        max-width: 500px;
        margin: 0 auto;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <bt-stepper class="bigmat-stepper">
        <bt-step-item id="step0">
          Step 1
          <input type="checkbox" id="step0-check" />
          <label for="step0-check">Accept</label>
        </bt-step-item>
        <bt-step-item id="step1">
          <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vehicula commodo magna, sed hendrerit ipsum viverra varius. Proin posuere arcu ligula, eget tempus sapien
            consequat nec. Aliquam at mauris nec purus finibus rutrum. Nunc tellus est, hendrerit et dapibus condimentum, tincidunt at metus. Vivamus at iaculis elit. Nunc quis
            consectetur velit. Pellentesque convallis justo lectus, quis volutpat elit bibendum in. Orci varius natoque penatibus et magnis dis parturient montes, nascetur
            ridiculus mus. Sed tincidunt ipsum mi, vel pretium nisi ornare nec.
          </p>
        </bt-step-item>
        <bt-step-item>Step 3</bt-step-item>
      </bt-stepper>
    </div>

    <script type="module">
      window.addEventListener('load', () => {
        const stepper = document.querySelector('.bigmat-stepper');
        const step1 = document.getElementById('step1');
        const checkbox = document.getElementById('step0-check');

        stepper.addEventListener('step', event => {
          console.log({ event });
          const index = event.detail;
          if (index === 0) {
            checkbox.addEventListener('change', () => {
              const isValid = checkbox.checked;
              stepper.setStepValidity(0, isValid);
            });
            stepper.setStepValidity(0, checkbox.checked);
          }
          if (index === 1) {
            stepper.setStepValidity(1, false);
            step1.task(async () => {
              await new Promise(resolve => setTimeout(resolve, 2000));
              stepper.setStepValidity(1, true);
            });
          }
        });
      });
    </script>
  </body>
</html>
